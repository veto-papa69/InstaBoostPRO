import{r as m,j as e}from"./ui-D3fYehC7.js";import{u as g,a as p,b as j,c as f,A as x,B as t}from"./index-BkDz3jxm.js";import{L as N}from"./router-BkWGCIhy.js";import"./vendor-BtP0CW_r.js";import"./utils-B2rm_Apj.js";import"./icons-CfQ0IvU1.js";import"./forms-NByhtiB_.js";function S(){const{isAuthenticated:i}=g(),{toast:l}=p(),[d,r]=m.useState(!1),[c,n]=m.useState(!1),{data:s,refetch:h}=j({queryKey:["/api/referrals"],enabled:i}),a=f({mutationFn:async()=>{const o=await fetch("/api/referrals/claim-reward",{method:"POST"});if(!o.ok)throw new Error("Failed to claim reward");return o.json()},onSuccess:()=>{l({title:"Reward Claimed!",description:"You can now enjoy 50% discount on all services!"}),h()},onError:()=>{l({title:"Error",description:"Failed to claim reward. Please try again.",variant:"destructive"})}});if(!i)return e.jsxs("div",{className:"min-h-screen pt-28 pb-8",style:{backgroundColor:"var(--main-bg)"},children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"mb-8",children:[e.jsx("i",{className:"fas fa-lock text-gold text-6xl mb-6"}),e.jsx("h1",{className:"text-4xl font-bold text-gold mb-4",children:"Login Required"}),e.jsx("p",{className:"text-xl text-cream/70 mb-8",children:"Please login with your Instagram account to access referral discounts"}),e.jsx("button",{onClick:()=>r(!0),className:"btn-primary px-8 py-3 text-lg",children:"Login Now"})]})})}),e.jsx(x,{isOpen:d,onClose:()=>r(!1)})]});const u=()=>{s!=null&&s.referralLink&&(navigator.clipboard.writeText(s.referralLink),n(!0),l({title:"Link Copied!",description:"Referral link copied to clipboard"}),setTimeout(()=>n(!1),3e3))},b=()=>{a.mutate()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-24 pb-16 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gold mb-4",children:"Referral Program"}),e.jsx("p",{className:"text-xl text-cream/70",children:"Invite 5 friends and get 50% discount on all services!"})]}),e.jsx("div",{className:"bg-charcoal border border-gold/20 rounded-xl p-8 mb-8",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{className:"bg-charcoal-dark border border-gold/10 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-gold mb-2",children:(s==null?void 0:s.referralCount)||0}),e.jsx("div",{className:"text-cream/70",children:"Successful Referrals"})]}),e.jsxs("div",{className:"bg-charcoal-dark border border-gold/10 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400 mb-2",children:5-((s==null?void 0:s.referralCount)||0)>0?5-((s==null?void 0:s.referralCount)||0):0}),e.jsx("div",{className:"text-cream/70",children:"Referrals Needed"})]}),e.jsxs("div",{className:"bg-charcoal-dark border border-gold/10 rounded-lg p-6",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-400 mb-2",children:"50%"}),e.jsx("div",{className:"text-cream/70",children:"Discount Reward"})]})]})}),e.jsxs("div",{className:"bg-charcoal border border-gold/20 rounded-xl p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gold",children:"Progress to Reward"}),e.jsxs("span",{className:"text-cream/70",children:[(s==null?void 0:s.referralCount)||0,"/5 referrals"]})]}),e.jsx("div",{className:"w-full bg-charcoal-dark rounded-full h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 h-4 rounded-full transition-all duration-500",style:{width:`${((s==null?void 0:s.referralCount)||0)/5*100}%`}})})]}),e.jsxs("div",{className:"bg-charcoal border border-gold/20 rounded-xl p-8 mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gold mb-4",children:"Your Referral Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 bg-charcoal-dark border border-gold/10 rounded-lg p-4",children:[e.jsx("div",{className:"text-cream/70 text-sm mb-1",children:"Share this link:"}),e.jsx("div",{className:"text-cream font-mono text-sm break-all",children:(s==null?void 0:s.referralLink)||"Loading..."})]}),e.jsxs(t,{onClick:u,className:"btn-primary whitespace-nowrap",disabled:!(s!=null&&s.referralLink),children:[e.jsx("i",{className:`fas ${c?"fa-check":"fa-copy"} mr-2`}),c?"Copied!":"Copy Link"]})]})]}),e.jsxs("div",{className:"bg-charcoal border border-gold/20 rounded-xl p-8 mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gold mb-6",children:"How it Works"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gold rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-charcoal font-bold",children:"1"})}),e.jsx("h4",{className:"font-semibold text-cream mb-2",children:"Share Your Link"}),e.jsx("p",{className:"text-cream/70 text-sm",children:"Copy and share your unique referral link with friends"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gold rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-charcoal font-bold",children:"2"})}),e.jsx("h4",{className:"font-semibold text-cream mb-2",children:"Friends Join"}),e.jsx("p",{className:"text-cream/70 text-sm",children:"When 5 unique friends sign up using your link"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gold rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-charcoal font-bold",children:"3"})}),e.jsx("h4",{className:"font-semibold text-cream mb-2",children:"Get Reward"}),e.jsx("p",{className:"text-cream/70 text-sm",children:"Claim your 50% discount on all services"})]})]})]}),(s==null?void 0:s.isEligibleForDiscount)&&!(s!=null&&s.hasClaimedDiscount)&&e.jsx("div",{className:"text-center",children:e.jsxs(t,{onClick:b,disabled:a.isPending,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold text-xl px-12 py-6 rounded-xl shadow-lg hover:scale-105 transition-all duration-300 pulse-glow",children:[a.isPending?e.jsx("i",{className:"fas fa-spinner fa-spin mr-3"}):e.jsx("i",{className:"fas fa-gift mr-3"}),"Claim Your Reward Now!"]})}),(s==null?void 0:s.hasClaimedDiscount)&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-400/30 rounded-xl p-6 mb-6",children:[e.jsx("i",{className:"fas fa-check-circle text-green-400 text-3xl mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-green-400 mb-2",children:"Reward Claimed!"}),e.jsx("p",{className:"text-cream/70",children:"You now have access to 50% discount on all services"})]}),e.jsx(N,{href:"/services",children:e.jsxs(t,{className:"btn-primary text-lg px-8 py-4",children:[e.jsx("i",{className:"fas fa-shopping-bag mr-2"}),"Shop with 50% Discount"]})})]})]})}),e.jsx(x,{isOpen:d,onClose:()=>r(!1)})]})}export{S as default};
